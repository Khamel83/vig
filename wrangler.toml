# Cloudflare Wrangler config for The Vig
name = "vig"
compatibility_date = "2025-01-20"

# Pages will use dist/ from Astro build
pages_build_output_dir = "dist"

# D1 Database
[[d1_databases]]
binding = "DB"
database_name = "vig-db"
database_id = "abd188fa-f8a2-4f4e-8802-4ac89e50bd37"

# KV Namespace for sessions/cache
[[kv_namespaces]]
binding = "KV"
id = "ba4d73038f8e46258df2a1d3c509b7f2"

# KV Namespace for Astro sessions
[[kv_namespaces]]
binding = "SESSION"
id = "ba4d73038f8e46258df2a1d3c509b7f2"

# Environment variables (non-secrets only)
[vars]
SITE_URL = "https://khamel.com"
GOOGLE_OAUTH_REDIRECT_URI = "https://khamel.com/api/auth/google-callback"

# Secrets are set via: wrangler pages secret put <NAME> --project-name=vig
# Required: JWT_SECRET, RESEND_API_KEY, THE_RUNDOWN_API_KEY
# Optional: GOOGLE_OAUTH_CLIENT_ID, GOOGLE_OAUTH_CLIENT_SECRET

# Note: Durable Objects and Queues require separate Worker deployment
# They are not supported directly in Pages
# TODO: Deploy leaderboard-worker separately for real-time features